/*
segment tree?

binary search until enough empties

keep track of ends
*/